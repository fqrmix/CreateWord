# CreateWord

Данный скрипт служит для автоматизации процесса заполнения готовых шаблонов в формате .docx данными, которые вводятся через формы.
Релизован посредством языка Visual Basic и интегрированных макросов в среде Microsoft Excel.

## Интерфейс.
![1](https://user-images.githubusercontent.com/90894198/149003902-555e182a-1a7b-450e-847a-c3305c5c1db7.png)

## Как работает.

* При нажатии на кнопку «Заполнить данные» появляется форма, предлагающая выбрать тип документа:
![2](https://user-images.githubusercontent.com/90894198/149003907-c2eb09ec-53ff-4f93-9bcd-4ed7dac7d4e6.png)

* Далее, в зависимости от выбранного типа, появляется форма, для заполнения данных (при этом поля динамически изменяются, в зависимости от шаблона – нужно в нем заполнение того или иного поля, или нет):
* 
![3](https://user-images.githubusercontent.com/90894198/149003911-a2e1f824-af03-4704-87d2-5dae1b2a5df2.png)

* После введения данных и нажатия на кнопку «Заполнить данные» - информация переносится на второй лист Excel «data» (он выполняет лишь техническую функцию, с ним никак взаимодействовать не нужно).

* После этого можно формировать подтверждение кнопкой «Сформировать подтверждение» на первом листе. Данные из второго («data») будут переносится в выбранный шаблон docx. Путь к ним указан на главном листе. 
Перенос данных происходит посредством замены идентификатора. Например: в шаблоне есть идентификатор [НомерDV]  (ровно так же, как он есть и на листе «data»). Поле в шаблоне заменится на то, которое находится ниже идентификатора, т.е в случае с номером документа и скрином выше – на 13.12.2021/24917710.
Так же, в форме есть галочка – «Создать PDF». В случае, если все идентификаторы заполнены и редактировать конечный документ будет не нужно – ее можно поставить, при этом к документу docx будет сразу создана его копия, в формате pdf. (!В случае с закрытым Юкардом нет смысла ее ставить, там нужно редактировать документ в зависимости от того, закрыл ли сам пользователь карту или срок ее действия истек!)

* Документы будут сохранены в папку Result, которая будет находится в том же каталоге, что и все файлы скрипта.

## Интересные моменты:

* Дата, при заполнении номера документа, берется та, которая установлена на компьютере. Нужен лишь номер тикета.
* В шаблонах с справками по кошельку сумма будет автоматически переведена из числового формата в текстовый: 0,00 -> Ноль рублей ноль копеек
* В шаблонах со справками дата так же будет браться с компьютера и преобразовываться в текстовый формат: 27.11.2021 -> 27 ноября 2021 года
* По умолчанию все копейки в суммах равны нулю. Если они отличны от 0 – есть соответствующий чек-бокс.


